<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="edu.spring.homeshare.ReplyMapper">


	<!-- insert -->
	
	<insert id="insert">
		insert into ${reply}
		values(0,#{houseNo},#{content},#{memId},null,#{replyScore},#{cleanScore},#{checkinScore})
		<!-- 0,하우스번호,content,memid,Score,cleaness,checkin -->
	</insert>

	<!-- select -->
	<select id="select_all_by_houseno" resultType="replyVO">
		select *
		from ${reply} where ${reply}.${houseNo} = #{houseNo}
	</select>

	<select id="select_count" resultType="int">
		select count(*) from ${reply}
	</select>
	
	<select id="select_count_by_houseno" resultType="Integer">
		select count(*) from ${reply} where ${reply}.${houseNo} = #{houseNo}
	</select>

	<!-- update -->
	<update id="update">
		update ${reply}
		set ${content} = #{content},
		${cleanScore} = #{cleanScore},
		${regdate}=#{regdate},
		${checkinScore} = #{checkinScore}
		where
		${rno} = #{rno}
	</update>

	<!-- delete -->
	<delete id="delete">
		delete from ${reply}
		where ${rno} = #{rno}
	</delete>
	
	
	<!-- 숙소기준 페이징 -->
	<select id="reportPaging" resultType="reportVO">
		select
		*
		from (
		select rownum rn,
		a.*
		from (
		select *
		from ${reply} where ${reply}.${houseNo} = #{houseNo}
		) a
		) b
		where rn
		between #{start} and #{end}
	</select>
	
	
	
	
	
	
	
	
	
	<!-- 리플 후기 평균 구하기 -->
	<select id="select_avg_score" resultType="double">
		<!-- select TRUNC(avg(${replyScore}),2) from ${reply} where ${reply}.${houseNo} = #{houseNo} -->
		select trunc(avg(${replyScore}),2) from ${reply} where ${reply}.${houseNo} = #{houseNo}
	</select>
</mapper>










